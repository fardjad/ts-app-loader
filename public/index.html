<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="light dark" />
  <title>TypeScript WebApp Loader</title>

  <script type="importmap">
      {
        "imports": {
          "typescript": "https://esm.sh/typescript@5.7.3",
          "@typescript/vfs": "https://esm.sh/@typescript/vfs@1.6.0",
          "mime/": "https://esm.sh/mime@4.0.6/"
        }
      }
    </script>
</head>

<body>
  <div id="app">
    <button id="accessDirButton">Load Directory</button>
  </div>

  <script type="module">
    import { buildProject, populateCache, registerServiceWorker } from './loader.js'

    document.querySelector('#accessDirButton').addEventListener('click', async () => {
      const dirHandle = await window.showDirectoryPicker();
      const fsMap = await buildProject(dirHandle);
      await populateCache(fsMap);

      window.location.href = "/index.html"
    });

    await registerServiceWorker();
  </script>
</body>

</html>